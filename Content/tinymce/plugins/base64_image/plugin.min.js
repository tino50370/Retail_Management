tinymce.PluginManager.add("base64_image", function (e, t) { e.addButton("base64_image", { icon: "image", tooltip: "Insert image", onclick: function () { e.windowManager.open({ title: "Insert image", url: t + "/dialog.html", width: 500, height: 150, buttons: [{ text: "Ok", classes: "widget btn primary first abs-layout-item", onclick: function () { var t = e.windowManager.getWindows()[0]; if ("" == t.getContentWindow().document.getElementById("content").value) return alert("Please select a file"), !1; if (t.getContentWindow().document.getElementById("content").files[0].size > 1024e3) return alert("Max image file size is 1MB"), !1; if ("image/jpeg" != t.getContentWindow().document.getElementById("content").files[0].type && "image/jpg" != t.getContentWindow().document.getElementById("content").files[0].type && "image/png" != t.getContentWindow().document.getElementById("content").files[0].type && "image/gif" != t.getContentWindow().document.getElementById("content").files[0].type) return alert("Only image file format can be uploaded"), !1; var n; n = new FormData, n.append("file", t.getContentWindow().document.getElementById("content").files[0]), $.ajax({ url: "/api/Editor/ConvertImageToBase64", data: n, processData: !1, contentType: !1, async: !1, type: "POST" }).done(function (n) { var i = t.getContentWindow().document.getElementById("desc").value, o = "data:" + t.getContentWindow().document.getElementById("content").files[0].type + ";base64," + n, a = '<img src="' + o + '" alt="' + i + '" style="max-width: 100%;" />'; alert(a); e.insertContent(a), t.close() }).fail(function () { alert("Request failed: " + jqXHR.responseText + " --- " + textStatus) }) } }, { text: "Close", onclick: "close" }] }) } }), e.addMenuItem("base64_image", { icon: "image", text: "Insert image", context: "insert", prependToContext: !0, onclick: function () { e.windowManager.open({ title: "Insert image", url: t + "/api/Editor/ConvertImageToBase64", width: 500, height: 150, buttons: [{ text: "Ok", classes: "widget btn primary first abs-layout-item", onclick: function () { var t = e.windowManager.getWindows()[0]; if ("" == t.getContentWindow().document.getElementById("content").value) return alert("Please select a file"), !1; if (t.getContentWindow().document.getElementById("content").files[0].size > 1024e3) return alert("Max image file size is 1MB"), !1; if ("image/jpeg" != t.getContentWindow().document.getElementById("content").files[0].type && "image/jpg" != t.getContentWindow().document.getElementById("content").files[0].type && "image/png" != t.getContentWindow().document.getElementById("content").files[0].type && "image/gif" != t.getContentWindow().document.getElementById("content").files[0].type) return alert("Only image file format can be uploaded"), !1; var n; n = new FormData, n.append("file", t.getContentWindow().document.getElementById("content").files[0]), $.ajax({ url: "/api/Editor/ConvertImageToBase64", data: n, processData: !1, contentType: !1, async: !1, type: "POST" }).done(function (n) { var i = t.getContentWindow().document.getElementById("desc").value, o = "data:" + t.getContentWindow().document.getElementById("content").files[0].type + ";base64," + n, a = '<img src="' + o + '" alt="' + i + '" style="max-width: 100%;" />'; e.insertContent(a), t.close() }).fail(function () { alert("Request failed: " + jqXHR.responseText + " --- " + textStatus) }) } }, { text: "Close", onclick: "close" }] }) } }) });